/* =========================================================
   TOKENS
========================================================= */
:root {
  --checkin:#38bdf8;
  --contacted:#fde68a;
  --paid:#86efac;
  --partial:#fcd34d;
  --unpaid:#fecaca;
  --panel-bg:#dee9f5;
  --res-card-min-h:104px;
}

/* =========================================================
   TAGS / PASTILLAS SEMÁNTICAS (en cards superiores)
========================================================= */
.tag { @apply px-2 py-0.5 text-xs rounded-md border; }
.tag--rcode   { @apply bg-white text-gray-800 border-black; }
.tag--depto   { @apply bg-gray-100 text-gray-900 border-black; }
.tag--depto--out { @apply bg-gray-100 text-gray-900 border-black; }
.tag--depto--in  { @apply bg-sky-200 text-gray-900 border-black; }
.tag--channel { @apply px-2 py-0.5 text-xs rounded-md bg-black text-white; }
.name--contacted { background: var(--contacted); @apply px-1 rounded; }

/* Píldora vertical (legacy) */
.res-card__bar { @apply w-2 rounded bg-gray-300; }
.res-card__bar--checkin { background: var(--checkin); }

/* =========================================================
   LAYOUT GLOBAL
========================================================= */
.app { @apply h-screen flex flex-col; }
.header { @apply p-3 border-b bg-white; }
.header__bar { @apply flex items-center justify-between; }
.header__title { @apply text-xl font-semibold; }
.header__date { @apply text-gray-500; }
.header__actions { @apply flex items-center gap-2; }
.btn { @apply inline-flex items-center justify-center px-2 py-1 border rounded bg-white hover:bg-gray-50; }
.input--date { @apply border rounded p-1; }

.main { @apply flex-1 flex flex-col min-h-0; }
.main__top { @apply flex items-end justify-between; position: relative; }
.loader { @apply text-gray-500; }

/* Vacio */
.empty { @apply text-gray-500; min-height: var(--res-card-min-h); padding-top: .25rem; }
.empty--as-card { @apply border rounded-lg bg-white hover:bg-gray-50; padding: .75rem; }

/* =========================================================
   TABS
========================================================= */
.tabsbar { @apply relative flex items-end; padding-left:.375rem; padding-right:.375rem; margin-top:3px; flex:1 1 auto; width:100%; background:#ffffff; }
.tabsbar::after { content:""; position:absolute; left:0; right:0; bottom:0; height:1px; background:#949494; z-index:2; }
.tab { @apply relative select-none px-4 py-2 text-sm rounded-t-xl; color:#111827; background:#f7f9fa; border:1px solid #cfd0d0; border-bottom:0; margin-bottom:-1px; margin-right:.25rem; transition:background .15s,color .15s,box-shadow .15s; z-index:1; }
.tab + .tab { margin-left:-1px; }
.tab:hover { background:#e5e7eb; }
.tab--active { background:var(--panel-bg); color:#0f172a; position:relative; z-index:3; box-shadow:0 1px 0 0 #f8fafc inset,0 -1px 0 0 #f8fafc inset,0 1px 3px #0000000f; border-color:#949494; }
.tab--active::after { content:""; position:absolute; left:-1px; right:-1px; bottom:0; height:2px; background:var(--panel-bg); z-index:4; }
.tab__count { @apply ml-2 inline-flex items-center justify-center h-5 min-w-[22px] px-1 text-[11px] font-semibold rounded-full border bg-sky-100 text-sky-800 border-sky-400; }

/* =========================================================
   PAGINADOR
========================================================= */
.pager { @apply flex items-center gap-2; }
.pager__btn { @apply px-2 py-1 border rounded bg-white hover:bg-gray-50 disabled:opacity-40; }
.pager__label { @apply text-sm text-gray-600; }

/* =========================================================
   LISTA SUPERIOR (GRID DE CARDS)
========================================================= */
.list { @apply flex-1 min-h-0; padding-top:.25rem; padding-left:.375rem; padding-right:.375rem; background:var(--panel-bg); }
.list__grid { @apply grid gap-3; }
.res-card  { @apply border rounded-lg p-3 hover:bg-gray-50 cursor-pointer; }
.res-card__row { @apply flex items-start gap-3 justify-between; }
.res-card__left { @apply flex items-start gap-3; }
.res-card__block { @apply flex flex-col; }
.res-card__line1 { @apply flex flex-wrap items-center gap-2; }
.res-card__line2 { @apply text-xs text-gray-600 mt-1; }
.res-card__line3 { @apply text-xs text-gray-500 mt-1; }

/* =========================================================
   BARRA ESTADO DERECHA (legacy)
========================================================= */
.status { @apply flex items-center gap-2 flex-row-reverse; }
.status__open { @apply text-sm px-3 py-1 rounded bg-black text-white; }

/* Badges de pago (en cards) */
.badge { @apply px-2 py-0.5 text-xs rounded-md; }
.badge--paid    { @apply text-gray-900; background: var(--paid); }
.badge--partial { @apply text-gray-900; background: var(--partial); }
.badge--unpaid  { @apply text-gray-900; background: var(--unpaid); }

/* Chips on/off (en popovers/listas) */
.chip { @apply px-2 py-0.5 text-xs rounded-md border; }
.chip--off   { @apply bg-white border-gray-300 text-gray-700; }
.chip--sky   { @apply bg-sky-100 border-sky-500 text-sky-800; }
.chip--amber { @apply bg-yellow-100 border-yellow-500 text-yellow-800; }

/* =========================================================
   CARD 4 CELDAS (TOP)
========================================================= */
.res-card4 { @apply relative border rounded-lg p-3 bg-white hover:bg-gray-50; display:grid; grid-template-columns: 1fr 1fr 1fr 120px; gap:0; min-height:var(--res-card-min-h); overflow:visible; }
.res-cell { @apply px-3; }
.res-cell--left { @apply flex flex-col gap-1; }

/* Divisores verticales */
.res-card4 > .res-cell { position: relative; }
.res-card4 > .res-cell:not(:last-child)::after { content:""; position:absolute; top:8px; bottom:8px; right:0; width:1px; background:#e5e7eb; }

/* Card activa con popover abierto */
.res-card4--active { outline:2px solid #93c5fd; outline-offset:2px; }

/* Línea 1/2/3 izquierda */
.left__line1 { @apply flex flex-wrap items-center gap-2; }
.left__line2 { @apply flex items-center gap-3 text-sm text-gray-700; }
.mail-link { @apply inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-200; }
.mail-link svg { width:16px; height:16px; }
.left__line3 { @apply flex flex-wrap items-center gap-2 text-xs text-gray-600; }

/* Línea 4: total a pagar + estado */
.left__line4 { @apply flex flex-wrap items-center gap-2 mt-1; }
.toPay-view { @apply inline-flex items-center gap-1; }
.toPay-cur  { @apply inline-flex items-center px-1.5 py-0.5 rounded-md border text-xs bg-white text-gray-800 border-gray-300; }
.toPay-input { @apply w-28 border rounded p-1 text-sm; }
.toPay-btn { @apply px-2 py-1 text-xs rounded border bg-white hover:bg-gray-50; }
.toPay-btn--icon { @apply p-1 w-7 h-7 rounded-full flex items-center justify-center; }
.toPay-btn--icon svg { width:16px; height:16px; }

/* =========================================================
   PANEL GENÉRICO (celdas 2 y 3)
========================================================= */
.panel { @apply h-full; display:grid; grid-template-columns:1fr auto; column-gap:.5rem; align-items:start; overflow:visible; }
.panel__list { @apply flex-1 text-sm text-gray-700 overflow-auto pr-2; max-height:100px; }
.panel__toolbar { @apply flex justify-end; align-self:start; }

/* =========================================================
   NOTAS
========================================================= */
.notes-empty { @apply text-gray-400 italic; }
.note-item { @apply pb-2; }
.note-head { @apply flex items-center justify-between; }
.note-meta { font-size:11px; @apply text-gray-500; }
.note-body { @apply whitespace-pre-wrap break-words; }
.note-sep  { @apply my-2 border-t; border-color:#e5e7eb; }

/* Botones + */
.notes-addwrap, .pay-addwrap { position:static; right:auto; bottom:auto; z-index:auto; }
.notes-addbtn, .pay-addbtn { @apply w-7 h-7 rounded-full border bg-white text-gray-700 leading-none flex items-center justify-center shadow hover:bg-gray-50; }

/* =========================================================
   PAGOS (lista interna)
========================================================= */
.payments-list { @apply pr-2 overflow-auto; max-height:100px; }
.payments-empty { @apply text-gray-400 italic; }
.pay-item { @apply grid items-center; grid-template-columns:1fr auto; gap:.25rem; padding:.125rem 0; }
.pay-left { @apply flex items-center gap-2; }
.pay-amt { @apply text-gray-700 text-right text-xs font-semibold; }
.pay-cur { @apply inline-flex items-center px-1.5 py-0.5 rounded-md border text-xs bg-white text-gray-800 border-gray-300; }
.pay-meta { font-size:11px; @apply text-gray-500; }
.pay-sep { @apply my-2 border-t; border-color:#e5e7eb; }
.pay-group-head { @apply flex items-center justify-between text-xs text-gray-600 mt-1 mb-1; }
.pay-total { @apply text-right text-xs font-semibold text-black; }

/* =========================================================
   NUEVO STACK DE ESTADOS (celda 4)
========================================================= */
.status-stack-new { @apply relative flex flex-col gap-2 pr-2; }
.pill-wrap { @apply relative; }
.pill-btn { @apply w-full h-7 px-2 text-xs rounded border flex items-center justify-center select-none; }
.pill-btn--neutral { @apply bg-gray-100 border-gray-300 text-gray-500; }
.pill-btn--neutral:hover { @apply bg-gray-200; }
.pill-btn--sky         { @apply bg-sky-50 border-sky-300 text-sky-800; }
.pill-btn--sky-active  { @apply bg-sky-100 border-sky-500 text-sky-900; }
.pill-btn--amber-active{ @apply bg-yellow-100 border-yellow-500 text-yellow-900; }
.pill-btn--gray-active { @apply bg-gray-200 border-gray-500 text-gray-900; }

/* =========================================================
   MINI POPOVER (PORTAL) + FIXES
========================================================= */
/* Posicionamiento lo maneja el componente con position:fixed */
.mini-popover { @apply p-3 rounded-lg border bg-white shadow-xl; width:auto; max-width:360px; z-index:1000; opacity:1; }
.mini-popover__title { @apply mb-2 text-sm font-semibold text-gray-800; }
.mini-popover__row { @apply mb-2; display:flex; flex-wrap:wrap; gap:.5rem; }
.mini-popover__row--note { @apply mb-3; }
.mini-popover__lab { @apply block text-xs text-gray-600 mb-1; width:100%; }
.mini-popover__field { @apply w-full border rounded p-2 text-sm; min-width:110px; }
.mini-popover__field--xs { width:90px; }     /* % IVA */
.mini-popover__field--s  { width:110px; }    /* IVA USD */
.mini-popover__actions { @apply flex items-center justify-end gap-2; }
.mini-popover__btn { @apply px-3 py-1.5 rounded text-sm; }
.mini-popover__btn--muted { @apply bg-gray-100 text-gray-800 border border-gray-300; }
.mini-popover__btn--ok { @apply bg-black text-white; }

/* Evitar recortes por contenedores 
.list, .res-card4, .res-cell, .panel { overflow: visible; }*/
.list { @apply flex-1 min-h-0; padding-top:.25rem; padding-left:.375rem; padding-right:.375rem; background:var(--panel-bg); overflow:auto; }

/* Ocultar stack viejo */
.status-stack { display:none; }
.pill-fixed  { display:none; }

/* =========================================================
   TABLA INFERIOR (BOTTOM)
========================================================= */
.bottom { @apply h-[30%] p-3 min-h-0; }
.tablewrap { @apply h-full overflow-auto border-t bg-white; }
.table { @apply w-full text-sm; }
.table thead { @apply sticky top-0 bg-white shadow; }
.th { @apply text-left p-2; }
.td { @apply p-2; }
.tr { @apply border-b hover:bg-gray-50; }

/* Quita estilo “card” en filas y control manual de separadores */
.table.btable .tr { border-bottom:none; }
.btr--res-sep { border-top:2px solid #0f172a; }   /* inicio de reserva */
.btr--pay     { border-top:1px solid #e5e7eb; }   /* subfilas de pagos */

/* Tipografía de montos */
.td--money-strong { font-size:.875rem; @apply text-black font-semibold text-right; }
.td--money-dim    { font-size:.875rem; @apply text-gray-700 font-semibold text-right; }

/* Celdas coloreadas por estado (sin pastillas) */
.td--depto-in        { background:var(--checkin);  color:#111827; }  /* Unidad con check-in */
.td--name-contacted  { background:var(--contacted); color:#111827; } /* Nombre si contactado */
.td--pay-paid        { background:var(--paid);     color:#111827; }  /* Pago */
.td--pay-partial     { background:var(--partial);  color:#111827; }
.td--pay-unpaid      { background:var(--unpaid);   color:#111827; }

/* (Compatibilidad con estilos anteriores de “pastilla” en tabla; no usados) */
.td__depto-tag { @apply inline-block px-2 py-0.5 rounded-md bg-gray-100 text-gray-900 border border-black; }
.td__depto-tag--in { @apply bg-sky-200; }
.td__name { @apply rounded px-1; }

/* Toolbar de export */
.btable__toolbar { @apply flex items-center justify-end py-2; }

/* =========================================================
   MODAL (legacy oculto)
========================================================= */
.modal-overlay { @apply hidden; }
.modal { @apply hidden; }


/* ======================================================
Icono de salida
========================================================== */
.icon-btn { @apply inline-flex items-center justify-center w-7 h-7 rounded-full border bg-white text-gray-700 hover:bg-gray-50; }
.icon-btn svg { width:16px; height:16px; }
/* ======================================================
BARRA DE NAVEGACIÓN (Dentro de una App)
========================================================== 
.portal-link-bar { background-color: #f9fafb; padding: 0.5rem 1.5rem; border-bottom: 1px solid #e5e7eb; }
.portal-link-bar a { color: #3b82f6; font-weight: 500; text-decoration: none; }
.portal-link-bar a:hover { text-decoration: underline; }*/

/* Asegura que el área de arriba y la tabla “repartan” el alto sin pisarse */
.main  { @apply flex-1 flex flex-col min-h-0; z-index:0; }
.bottom { @apply h-[30%] p-3 min-h-0; position:relative; z-index:1; }

/* agrupación por propiedad en tarjetas */
.prop-group { margin: 16px 0 24px; }
.prop-group__title {
  font-size: 14px; font-weight: 600; opacity: .75;
  margin: 8px 0 12px; border-left: 3px solid #ddd; padding-left: 8px;
}

/* tabla: fila de grupo y separadores */
.btr--group td { border-top: 2px solid #000; }
.btr--res-sep td { border-top: 1px solid #111; }

/* boton switch dolares a pesos*/
.toPay-btn--switch{font-size:12px;padding:2px 8px;border:1px solid #e5e7eb;border-radius:9999px;background:#fff;line-height:1;cursor:pointer} 
.toPay-btn--switch:hover{background:#f8fafc}

.header__userline { @apply inline-flex items-center text-sm text-gray-700; }
.header__userline__avatar { @apply w-5 h-5 rounded-full border border-gray-200 ml-2; object-fit: cover; }

/* ─────────────────────────────────────────────────────────
   Hints "Original WuBook" (debajo del label)
   ───────────────────────────────────────────────────────── */
.mini-popover__hint {  @apply text-xs text-gray-500;  margin-top: -2px;  margin-bottom: 4px;}

/* Fila del popover en columna (label → hint → input) */
.mini-popover__row--col {  display: flex; flex-direction: column; align-items: stretch;}

/* ─────────────────────────────────────────────────────────
   Pie de auditoría "Modificado por ..."
   ───────────────────────────────────────────────────────── */
.mini-popover__audit { @apply text-gray-500; font-size: 11px; line-height: 1.1;
}
.mini-popover__audit b { @apply text-gray-800; }
.mini-popover__audit time { opacity: .8; }

/* =========================================================
   MOBILE (≤640px) — versión compacta
========================================================= */
@media (max-width: 640px) {
  .app { height: 100dvh; }
  .header { padding: .5rem .75rem; }
  .header__title { font-size: 1rem; }
  .header__date { display: none; }
  .header__actions { gap: .375rem; }
  .btn { padding: .25rem .5rem; font-size: .85rem; }
  .input--date { height: 32px; padding: .25rem .5rem; font-size: .85rem; }
  .tabsbar { overflow-x: auto; padding-left: .25rem; padding-right: .25rem; }
  .tab { white-space: nowrap; padding: .375rem .625rem; font-size: .85rem; }
  .tab__count { height: 18px; min-width: 20px; font-size: 10px; }
  .list { padding: .5rem .5rem 5rem; }
  .res-card4 { display: grid; grid-template-columns: 1fr; gap: .5rem; min-height: auto; padding: .75rem; }
  .res-card4 > .res-cell:not(:last-child)::after { display: none; }
  .left__line1 { gap: .375rem; }
  .left__line2 { font-size: .9rem; gap: .5rem; }
  .left__line3 { gap: .375rem; }
  .name--contacted { padding: 0 .25rem; }
  .panel { grid-template-columns: 1fr; }
  .panel__list { max-height: none; overflow: visible; padding-right: 0; }
  .payments-list { max-height: none; overflow: visible; }
  .toPay-btn { padding: .375rem .5rem; }
  .toPay-btn--icon { width: 34px; height: 34px; }
  .toPay-cur { font-size: .75rem; }
  .status-stack-new { position: sticky; bottom: .5rem; z-index: 5; background: #fff; border: 1px solid #e5e7eb; border-radius: .75rem; padding: .5rem; box-shadow: 0 2px 10px rgba(0,0,0,.04); flex-direction: row; gap: .5rem; }
  .pill-btn { height: 40px; font-size: .85rem; padding: 0 .75rem; }
  .pill-btn--neutral, .pill-btn--sky, .pill-btn--amber-active, .pill-btn--gray-active { border-width: 1px; }
  .mini-popover { left: 8px !important; right: 8px !important; bottom: 8px !important; top: auto !important; width: auto; max-width: none; border-radius: 12px; }
  .mini-popover__field { font-size: .95rem; }
  .bottom { display: none; }
}

/* =========================================================
   TABLET (641–1024px) — dos columnas cómodas
========================================================= */
@media (min-width: 641px) and (max-width: 1024px) {
  .res-card4 { grid-template-columns: 1fr 1fr; gap: .75rem; }
  .res-card4 > .res-cell:nth-child(2n)::after { display: none; }
  .bottom { display: none; }
}
